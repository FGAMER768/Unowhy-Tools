/*

                                                                                                                                                      
                                                                                                                                                      
                                                                                                                                                      
                                                                                                                                                      
                                                                                                                                                      
                                                                                                                                                      
                                                                                                                                                      
                                                                                                                                                      
                                                                                                                                                      
                                                                                                                                                      
                                                                                                                                                      
                                                                                                                                                      
                                                                                                                                                      
      ░▒▓▓▒▓▒▓▒▒                                                     ░▒▓▓▓▓▓▒▓▒░                                                     ▒▓▓▒▓▒▓▓▒        
     ▓███████████▒                                                 ░█████████████░                                                 ▒███████████▓      
    ▓█████████████░                                                ███████████████                                                ▒█████████████▓     
    ███▓█▓█▓█▓█▓██▒                                               ░████▓█▓███▓████░                                               ▒████▓█▓█▓█▓███     
    ████▓█▓█▓█▓███▒                                                ███▓█▓█▓█▓█████░                                               ▒███▓██████████     
    ███▓█▓█████▓██▒                                               ░████▓█▓███▓████░                                               ▒██▓█▓█▓█▓█▓███     
    ████▓█▓█▓█████▒                                                ███▓█▓█▓█▓█▓███░                                               ▒███▓█▓█▓█▓████     
    ███▓█▓█▓███▓██▒                                               ░██▓█▓█▓█▓█▓████░                                               ▒██▓█▓███▓█▓███     
    ████▓█▓███▓███▒                                               ░███▓███▓█▓█▓███░                                               ▒███▓█▓█▓█▓████     
    ███▓█▓█▓█▓█▓██▒                                               ░████▓███▓█▓████░                                               ▒████▓█▓███▓███     
    ████▓█▓█▓█████▒                                               ░███▓███▓█▓█▓███░                                               ▒███▓█▓█▓██████     
    ███▓█▓█▓█▓████▒                                               ░████▓█▓█▓█▓████░                                               ▒██▓█▓█▓█▓█████     
    ████▓███▓█▓███▒                                                ███▓█████▓█▓███░                                               ▒█████▓█▓█▓████     
    █████▓█▓█▓█▓██▒                                               ░████▓█▓█▓██████░                                               ▒██▓███▓█▓█▓███     
    ██████▓█▓█▓███▒                                                ███▓█▓█▓█▓█▓███░                                               ░███▓█▓█▓█▓████     
    ███▓█▓███▓█▓███▓░                                             ░████▓█▓█▓█▓█▓██░                                             ░▓█████▓█████▓███     
    ████▓███████▓█████▓▒                                           ███▓███▓█▓█▓███░                                          ▒▓█████▓█▓█▓█▓██████     
    ███▓█▓█▓█▓█▓█████████▓▓░                                      ░████▓█▓█▓█▓█▓██░                                      ░▓████████▓███▓█▓█▓█▓███     
    ████▓█▓█▓█▓███▓█▓████████▓▒                                   ░███████████████░                                   ▒▓████████▓█▓█▓█████▓█▓████     
    ███████▓█▓█▓█▓█▓█▓█▓████████▓▒░                                ▓█████████████▓                                ░▒█████████▓█▓█▓█▓█▓███▓███████     
     ███████▓███▓█▓█▓█▓█▓███████████▓░                              ▒▓██████████▒                              ░▓█████████▓███▓█▓█▓█▓███████████      
      ░▓█████████▓█▓█▓█▓█▓█▓█▓█████████▓▒                                                                   ▒▓███████████▓█▓███▓█████████████▓░       
          ▒▓████████████▓█▓███▓█▓██████████▓░                                                           ░▓████████▓█▓███▓█████▓██████████▓▒           
             ░▓██████████▓█▓█▓█████▓█▓████████▓▒                                                     ▒▓████████▓█▓█▓█▓█▓█▓████████████▓░              
                 ▒▓███████▓█▓█▓█▓█▓█▓█████████████▒░                                             ░▒█████████▓█▓███▓█▓█▓█▓█████████▓▒                  
                    ▒▓█████████▓█▓█▓█▓█████▓█████████▓▒                                       ▒▓███████████▓█▓█▓█▓█████████████▓▒                     
                       ░▒███████████▓█▓█▓█▓███▓█████████▓▒                                 ▒▓███████▓█▓███████▓█▓███████████▒░                        
                           ▒▓████████▓█▓█▓█▓█▓██████████████▓░                         ░▓████████▓█▓█▓█▓█████▓█▓████████▓▒                            
                              ░▓██████████▓█▓█▓█▓███▓█▓████████▓▒                   ▒▓████████▓█▓█▓█▓█▓█▓████████████▓░                               
                                  ▒▓███████▓█▓█▓█▓█▓█▓█▓█▓█████████▒░           ░▒█████████▓███▓█▓███▓█▓█████████▓▒                                   
                                     ░▓█████████▓█▓█▓█▓█▓█▓█▓█████████▓▒     ▒▓█████████▓█▓█▓███▓█▓███████████▓▒                                      
                                        ░▒▓████████▓█▓█▓█▓█▓█▓█▓█████████▓▓▓█████████▓█▓█▓███▓█▓███████████▒                                          
                                            ▒▓██████████▓█▓█▓█▓█▓█▓█▓███████████▓█▓█████▓█▓█▓██████████▓▒                                             
                                               ░▒██████████▓█▓█▓█▓█▓█▓█████████▓█▓█▓█▓███▓█▓████████▓░                                                
                                                   ▒▓███████████▓█▓█▓███▓█▓█▓███▓█▓█▓███████████▓▒                                                    
                                                      ░▓█████████▓█▓█▓███▓█▓█▓█▓███▓█████████▓░                                                       
                                                          ▒▓████████▓█▓█▓█▓█▓█▓██████████▓▒                                                           
                                                             ▒▓██████▓███▓███▓█▓██████▓▒                    ░▒▓▓               ░▓▓▒░                  
                                                                ░▒▓█████▓███▓█▓███▓▒░                    ▒▓▓▓▓▓▓▓░            ▒▓▓▓▓▓▓▒░               
                                                                   ██▓███▓███▓████                    ░▒▓▓▓▓▓▓▓▓▓▓▓░        ▒▓▓▓▓▓▓▓▓▓▓▓▒             
                                                                   █████▓█▓█▓█▓███                   ░█▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓█▓            
                                                                  ░████▓███▓█▓████░                   ▒▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░            
                                                                  ░███▓█▓█▓█▓█▓███░                    ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▒             
                                                                  ░██████▓█▓█▓█▓██░                    ▒▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▒             
                                                                   █████▓█▓█▓█████░                    ▓▓▓▓▓▓▓▓▓▓▓▓▒▒▒░░░░░▒▒▓▓▓▓▓▓▓▓▓▓▓▒             
                                                                  ░██▓█▓███▓█▓█▓██░                   ▒▓▓▓▓▓▓▓▓▓▒░░░░         ░▒▓▓▓▓▓▓▓▓▓             
                                                                   █████▓█▓█▓█▓███░                  ░▓▓▓▓▓▓▓▓▒░░░   ░░░░░       ▒▓▓▓▓▓▓▓▓            
                                                                  ░██▓█▓█▓█▓██████░                 ▒▓▓▓▓▓▓▓▓░░░░ ▒▓███████▓▓░     ▓▓▓▓▓▓▓▓▒          
                                                                   ███▓█▓█▓█▓█████░             ░▒▓▓▓▓▓▓▓▓▓▓░░░ ░▓████████████▓  ░  ▓▓▓▓▓▓▓█▓▓░       
                                                                  ░████▓█▓█▓█▓████░         ░█▓▓▓▓▓▓▓▓▓▓▓▓▓░░░ ░████████████████  ░  ▓▓▓▓▓▓▓▓▓████▓   
                                                                  ░███▓█▓█▓█▓█████░         ▒█▓▓▓▓▓▓▓▓▓▓▓▓▒░░░ █████▓███▓███████▓    ▒▓▓▓▓▓▓▓▓▓▓▓▓█░  
                                                                   ███████████████          ▒▓▓▓▓▓▓▓▓▓▓▓▓▓░░░ ▒████▓█████████████    ░█▓▓▓▓▓▓▓▓▓▓▓█░  
                                                                   ░█████████████░          ▒▓▓▓▓▓▓▓▓▓▓▓▓▓░░░ ▒██████████████████░   ░▓▓▓▓▓▓▓▓▓▓▓▓█░  
                                                                     ░▒▒▒▒▒▒▓▒▒░            ▒▓▓▓▓▓▓▓▓▓▓▓▓▓░ ░ ░██████████████████    ▒█▓▓▓▓▓▓▓▓▓▓▓█░  
                                                                                            ░█▓▓▓▓▓▓▓▓▓▓▓▓▒  ░ ▓████████████████░    ▓▓▓▓▓▓▓▓▓▓████   
                                                                                             ▒▒▒▓▓▓▓▓▓▓▓▓▓▓░    ▓██████████████▒    ▒█▓▓▓▓▓▓██▓▓▓▓▒   
                                                                                                   ▒▓▓▓▓▓▓▓▓░    ░▓██████████▓     ░█▓▓▓▓▓██▒         
                                                                                                     ▓█▓▓▓▓▓▓▒      ░▒▓▓▓▓▒░      ▒█▓▓▓▓▓█▓           
                                                                                                      ▒▓▓▓▓▓▓█▓░                ░▓█▓▓▓▓▓█▒            
                                                                                                       ▓▓▓▓▓▓▓▓▓▓▒░          ░▓▓█▓▓▓▓▓▓▓▓             
                                                                                                       ▓▓▓▓▓▓▓▓▓▓███▓▓▓▓▓▓▓▓███▓▓▓▓▓▓▓▓█▒             
                                                                                                       ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓█▓██▓▓▓▓▓▓▓▓▓▓▓▓▓█▒             
                                                                                                       █▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓             
                                                                                                      ██▓▓▓▓▓▓▓▓▓▓▓▓████████▓▓▓▓▓▓▓▓▓▓▓▓█▓            
                                                                                                      ▓██▓▓▓▓▓▓▓▓▓█▓▒▒░░░░▒▓▓█▓▓▓▓▓▓▓▓███▓            
                                                                                                        ▒▓███▓▓▓█▓░          ░▓█▓▓▓███▓▒              
                                                                                                           ▒▓███▒              ▓███▓▒░                
                                                                                                              ░░                ░░                    
                                                                                                                                                      
                                                                                                                                                      
                                                                                                                                                      
                                                                                                                                                      
                                                                                                                                                      
                                                                                                                                                      
                                                                                                                                                      

                                       


                                                                ░░░░░░░░░░░░░░░░░░░░░░▒░    ░                                                         
                               ██████████████████████████████████████████████████████████████████████████████████████████                             
                              ▒█████████████████████████████████████████████████████████████  ███████████████████████████                             
                              ░█████████████████████████████████████████████████████████████  ███████████████████████████                             
                              ░█████████████████████████████████████████████████████████████  ███████████████████████████                             
                              ░█████████████████████████████████████████████████████████████  ███████████████████████████                             
                              ░████████████▓▓▓▓▓▓▓▓█████████████████████████████████████████  ███████████████████████████                             
                              ░███████▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓                             ▒█████  ███████████████████████████                             
                              ░████▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓█  ▒▒▒▒▒▒▒▒▒▒▓▓▓▓▓▒ ░▓▓▓▓▓▓▓▒ ░█████  ███████████████████████████                             
                              ░███▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓█  █████████▓██████ ▓████████ ░█▓▓▓█  █▓▓▓▓▓█████████████████████                             
                              ▒██▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓█  ████████▓▓▓▓▓▓▓▒ ▒██▓▓▓▓▓▒ ░█▓▓▓█  ▓▓▒▒▒▒▒▒▒▓▓██████████▓▓▓▓▓█                             
                              ░█▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓█           █▓▓▓▓█▒ ░▓▒▒▒▒▒▓▒         ▓▓▓▓▓▓▒▓▒▒▒▒▒▓▓█▓▓▓▓▓▓▓▓▓██                             
                              ▒█▓▓▓▓▓▓▓▓▓▓▓▓▓▒▒▒▒▒▒▒▒▒▒▒▓▒▓▒▓▒▓▓▓▒  █▓▓▒▒▓▒ ░▓▒▒▒▒▒▒▒▒▒▒░ ░▓▓▒▓▓▓▓▓▓▓▒▓▓▓▓▓▒▒▒▓▓▓▓▓▓▓▓▓▓█                             
                              ▒█████▓▓▓▓▒▓▒▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓██▓  ▓▒▒▒▒▓▒ ░▓▒▒▒▒▒▒▒▓▓▓░ ░█▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▒▒▒▓▓▓▓▓▓▓█                             
                              ▒█▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒  ▓▒▒▒▓▓▒ ░▓▓▒▒▒▒▒▒▒▓▓▒ ▒█▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓███                             
                              ▒▒                                   ░▓▓▓▓▓▓▒ ▒█▓▓▓▓▓▓▓▓▓█▒ ▒█▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓█                             
                              ▒█▓▓▓▓▓▓▓▓▓▓███████████████▓▓▓▓▓▓▓▓▓█▓▓▓▓▓▓▓███████▓█▓▓▓█▓▓▓█▓█▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▒█                             
                              ▒█▒▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓    ▓█▒         ▓▒            ▒█▓    ▓▓▓▓▓▓▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▓▓▓█                             
                              ▒█▒▒▒▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▒▓  ▓█▒ ░▓▓▓▓▓▒▓█▒ ▒▓▓▒▓▒▓▒▓░ ▒█▓▓▓  █▓▓▓▓▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒█                             
                              ▒█▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓█░ ▓█▒ ▒██▓▓▓▓▓█░ ▒█▓▓▓█▓██▒ ▒█▓▓█  ▓▓▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒█                             
                              ▒█▒▓▓▓▓▓▓▒▓▒▓▓▓▒▓▓▓▓▓▓▓▓▓▓▓▓█  ▓█▒ ░█▓▓▓▓▓▓█▒ ▒█▓▓▓▓▓▓█░ ▒█▓▓█  █▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▒▒▒▒▒█                             
                              ▒███▓▓▓▓▓▓▓▓▒▒▒▒▒▒▒▒▒▒▒▒▒▓▒▓▓  ▓█▒ ▒█▓▓▓▓▓▓█▒ ▒█▓▓▓▓▓██▒ ▓████  ████▓█▓█▓█▓█▓█▓█▓█▓████▓▓▓█                             
                              ▒███████████████▓▓▓▓▓▓▓▓▓▓▓▓█  ██▒ ▒███▓█▓██▒ ▒█▓▓▓▓▓▓█▒ ▒█▓██  ██▓▓▓▓▓▓▓▓█▓▓▓▓▓█▓▓▓█▓█▓▓▓█                             
                              ▒██████████████████████▓▓▓▓▓█  ██▒ ▒██▓█████▒ ▒████████▒ ▒█▓▓█  ███████████████████████████                             
                              ▒████████████████████████████  ██▒  ▒▒▒▒▒▒▒▒░ ▒▓▒▒▒▒▒▒▒  ▒█▓▓█  ▓▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▓▓▓▓█                             
                              ▒████████████████████████████░ ██▓            ▒▒         ▒▓▓▓█                            █░                            
                              ▒████████████████████████████  ███████████████████████████▓▓▓▓█████████████████████████████                             
                              ▒████████████████████████████░ ████████████████████████████████████████████████████████████                             
                              ▒████████████████████████████  ████████████████████████████████████████████████████████████                             
                              ▒████████████████████████████░ ████████████████████████████████████████████████████████████                             
                              ▒████████████████████████████  ████████████████████████████████████████████████████████████                             
                              ▒████████████████████████████  ████████████████████████████████████████████████████████████                             
                              ▒██████████████████████████████████████████████████████████████████████████████████████████                             
                              ▒██████████████████████████████████████████████████████████████████████████████████████████                             
                              ▒████████▓▓▓▓▓█▓█▓█▓█▓███▓█▓███████████████████████████████████████████████████████████████                             
                              ▒█▓▓▓▓▓▓▓▓▓▓▓█▓▓▓▓▓▓▓▓▓█▓█▓█▓█▓████████████████████████████████████████████████████▓▓▓▓▓▓██                             
                              ███████████████████████████████████████████████████████████████████████████████████████████▓                            
                             ███████████████████████████████████████████████████████████████▓█████████████████████████████▒                           
                            ▒█▓██████████████████████████████████████████████████████████████████████████████████████████▓█                           
                           ░█▓▓▓████████████████████████████████████████████████████████████████████████████████████████▓▓██                          
                           ██▓▓▓████████████████████████████████████████████████████████████████████████████████████████▓▓▓█▓                         
                          ▓█▓▓▓▓████████████████████████████████████████████████████████████████████████████████████████▓▓▓▓█░                        
                         ░█▓▓▓▓██▓█████████████████████████▓█████▓█████▓█████▓█████▓█████████████████████████████████▓██▓▓▓▓██                        
                         █▓▓▓▓▓█▓███████████████▓████████████████████████████████████████████████████████████████████████▓▓▓▓█▓                       
                        ▓█▓▓▓▓█████████████████▓▓████████████████████████████████████████████████████████████▓█▓█████▓█▓██▓▓▓▓█▒                      
                       ▒█▓▓▓▓▓▓▓▓▓████████████████████████████████████████████████████████████████████████████████████▓▓▓▓▓▓▓▓▓█                      
                      ░█▓▓▓▓▓▓▓▓▓▓▓████████████████████████████████████████▓███████▓█████████████████████████████████▓▓▓▓▓▓▓▓▓▓██                     
                      ██▓▓▓▓▓▓▓▓▓▓▓███████████████████████████████▓█████████████████▓███████████████████████████████▓▓▓▓▓▓▓▓▓▓▓▓█▓                    
                     ▓█▓▓▓▓▓▓▓▓▓▓▓▓▓███████████████████████████████▓███████▓███████████████▓█████████████████████████▓▓▓▓▓▓▓▓▓▓▓▓█░                   
                    ▒█▓▓▓▓▓▓▓▓▓▓▓▓▓███████████████████████████████▓█▓█████▓█▓███████████████▓███████████████████████▓▓▓▓▓▓▓▓▓▓▓▓▓██                   
                    █▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓█▓█████████████████████████████████████████████████████████████████████████████▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓█▓                  
                   ██▓▓▓▓▓▓▓▓▓▓▓▓▓▓█████████████████████████████████████████████████████████████████████████████████▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓█▒                 
                  ▓██████████████████████████████████████████████████████████████████████████████████████████████████████████████████░                
                  ░▓▓▓▓▓▒▓▓▓▒▓▒▓▒▓▒▓▒▒▒▒▒▒▒▓▒▒▒▓▒▒▒▒▒▓▒▒▒▒▒▒▒▒▒▓▒▒▒▓▒▒▒▓▒▒▒▒▒▒▒▓▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▓▒▒▒▒▒▓▒▓▒▒▒▓▒▒▒▓▒▓▓▓▒▓▒▓▒▓▓▓▓▓▓                 
                                                                                                                                                      
                                                                                                                                                      




                                             ================================================================= 

                                                                Unowhy Tools by STY1001                                                                                                                                                      
                                                               A tool for Y13 computer !

                                                        https://sty1001.wordpress.com/unowhy-tools/
                                                         https://github.com/STY1001/Unowhy-Tools/

                                                Unowhy Tools and STY1001 are NOT affiliate with Unowhy !

                                                          Unowhy Tools is free and open source !

                                                               Don't steal my project/work ! 

                                             ================================================================= 
                                                                                                                                                                                                                                                                      

*/

using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Diagnostics;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.IO;
using Microsoft.Win32;
using System.Windows.Forms;
using System.Globalization;
using System.Resources;
using System.Net;
using System.Runtime.InteropServices;
using System.Windows;
using System.Threading;
using System.Windows.Input;
using System.ServiceProcess;
using Microsoft.WindowsAPICodePack.Shell;
using Microsoft.WindowsAPICodePack.Taskbar;
using System.Security.Principal;
using System.Windows.Forms.VisualStyles;

namespace Unowhy_Tools
{   
    public partial class main : Form
    {
        #region Public Strings

        public string resxFile = "null";
        public string hnpcn = "null";
        public string mf = "null";
        public string model = "null";
        public string ene = "null";
        public string ifp = "null";
        public string os = "null";

        #endregion

        #region Threads

        public void SplashScreen()
        {
            Application.Run(new Splash());
        }

        public void WaitScreen()
        {
            Application.Run(new wait());
        }

        #endregion

        #region Check Service Function

        public bool serviceExists(string ServiceName)
        {
            return ServiceController.GetServices().Any(serviceController => serviceController.ServiceName.Equals(ServiceName));
        }

        #endregion

        #region Check admin

        public static bool checkAdmin()
        {
            WindowsIdentity identity = WindowsIdentity.GetCurrent();
            WindowsPrincipal principal = new WindowsPrincipal(identity);
            return principal.IsInRole(WindowsBuiltInRole.Administrator);
        }

        #endregion

        #region Run admin

        private void runAdmin()
        {
            if (!checkAdmin())
            {
                // Restart and run as admin
                var exeName = Process.GetCurrentProcess().MainModule.FileName;
                ProcessStartInfo startInfo = new ProcessStartInfo(exeName);
                startInfo.WorkingDirectory = Directory.GetCurrentDirectory();
                startInfo.Verb = "runas";
                string getidpath = Environment.GetFolderPath(Environment.SpecialFolder.UserProfile);
                startInfo.Arguments = $"-u {getidpath}";
                Process.Start(startInfo);
                Application.Exit();
                this.Close();
            }
        }

        #endregion
        
        #region Dark Title Bar

        //Set dark mode title bar

        [DllImport("DwmApi")] 
        private static extern int DwmSetWindowAttribute(IntPtr hwnd, int attr, int[] attrValue, int attrSize);

        protected override void OnHandleCreated(EventArgs e)
        {
            DwmSetWindowAttribute(Handle, 19, new[] { 1 }, 4);
            DwmSetWindowAttribute(Handle, 20, new[] { 1 }, 4);
            DwmSetWindowAttribute(Handle, 35, new[] { 1 }, 4);
            DwmSetWindowAttribute(Handle, 38, new[] { 1 }, 4);
        }

        #endregion

        #region Check Internet Fonction

        [DllImport("wininet.dll")]
        private extern static bool InternetGetConnectedState(out int state, int value);

        #endregion

        public main(string userpath)
        {
            Thread t = new Thread(new ThreadStart(SplashScreen));               //Splash Screen
            t.Start();
            delay(300);

            #region Get info without admin

            if (checkAdmin())
            {
                /*string filePath9 = "%userprofile%\\Unowhy Tools\\temp\\workdir.txt";
                int lineNumber9 = 1;
                StreamReader inputFile9 = new StreamReader(filePath9);

                for (int i = 1; i < lineNumber9; i++)
                {
                    inputFile9.ReadLine();
                }
                string workdir = inputFile9.ReadLine();

                Directory.SetCurrentDirectory(workdir);*/
                if (!Directory.Exists($"{userpath}\\Unowhy Tools"))
                {
                   Directory.CreateDirectory($"{userpath}\\Unowhy Tools");
                }

                if (!Directory.Exists($"{userpath}\\Unowhy Tools\\temp"))
                {
                    Directory.CreateDirectory($"{userpath}\\Unowhy Tools\\temp");
                }

                if(!File.Exists($"{userpath}\\Unowhy Tools\\temp\\realid.txt"))
                {
                    string realid = System.Security.Principal.WindowsIdentity.GetCurrent().Name;
                    File.WriteAllText($"{userpath}\\Unowhy Tools\\temp\\realid.txt", realid);
                }

                if (!File.Exists($"{userpath}\\Unowhy Tools\\temp\\compuser.txt"))
                {
                    string compiduser = System.Security.Principal.WindowsIdentity.GetCurrent().Name;
                    File.WriteAllText($"{userpath}\\Unowhy Tools\\temp\\compuser.txt", compiduser);
                }

                if (!File.Exists($"{userpath}\\Unowhy Tools\\temp\\user.txt"))
                {
                    string iduser = Environment.UserName;
                    File.WriteAllText($"{userpath}\\Unowhy Tools\\temp\\user.txt", iduser);
                }
            }
            else
            {
                // Get user id of Invoker (Real user)
                string realid = System.Security.Principal.WindowsIdentity.GetCurrent().Name;
                string compiduser = System.Security.Principal.WindowsIdentity.GetCurrent().Name;
                string iduser = Environment.UserName;
                //string workdir = Directory.GetCurrentDirectory();
                string profpath = Environment.GetFolderPath(Environment.SpecialFolder.UserProfile);
                if (!Directory.Exists($"{profpath}\\Unowhy Tools"))
                {
                    Directory.CreateDirectory($"{profpath}\\Unowhy Tools");
                }
                if (!Directory.Exists($"{profpath}\\Unowhy Tools\\temp"))
                {
                    Directory.CreateDirectory($"{profpath}\\Unowhy Tools\\temp");
                }
                File.WriteAllText($"{profpath}\\Unowhy Tools\\temp\\realid.txt", realid);
                File.WriteAllText($"{profpath}\\Unowhy Tools\\temp\\compuser.txt", compiduser);
                File.WriteAllText($"{profpath}\\Unowhy Tools\\temp\\user.txt", iduser);
                //File.WriteAllText("%userprofile%\\Unowhy Tools\\temp\\workdir.txt", workdir);
                delay(300);
                t.Abort();
                InitializeComponent();
                runAdmin();
            }

            #endregion

            if (checkAdmin())
            {
                #region First Start

                //File.WriteAllText(".\\temp\\verbose.txt", "Preparing...");

                if (Directory.Exists("temp"))
                {

                }
                else
                {
                    Directory.CreateDirectory("temp");
                    //File.WriteAllText(".\\temp\\verbose.txt", "Preparing for first start...");
                }

                RegistryKey keysty = Registry.CurrentUser.OpenSubKey(@"Software\STY1001", false);   //Check if the  "STY1001" key exist
                if (keysty != null)
                {

                }
                else
                {
                    RegistryKey stykey = Registry.CurrentUser.OpenSubKey(@"Software", true);    //Create it
                    stykey.CreateSubKey("STY1001");
                    delay(300);
                }

                RegistryKey keyut = Registry.CurrentUser.OpenSubKey(@"Software\STY1001\Unowhy Tools", false);   //Check if "UT" key exist
                if (keyut != null)
                {

                }
                else
                {
                    RegistryKey utkey = Registry.CurrentUser.OpenSubKey(@"Software\STY1001", true);     //Create it with "Lang" value
                    utkey.CreateSubKey("Unowhy Tools");
                    delay(300);

                }

                RegistryKey key = Registry.CurrentUser.OpenSubKey(@"SOFTWARE\STY1001\Unowhy Tools");       //Open key
                object us = key.GetValue("UpdateStart", null);
                if (us != null)
                {

                }
                else
                {
                    //Set check boot at startup at on
                    Process p = new Process();
                    p.StartInfo.FileName = ".\\cuabon.exe";
                    p.StartInfo.Arguments = "";
                    p.StartInfo.WindowStyle = ProcessWindowStyle.Minimized;
                    p.Start();
                    p.WaitForExit();    //Wait the registery editing
                }

                object o = key.GetValue("Lang", null);
                if (o != null)
                {

                }
                else
                {
                    Process p = new Process();
                    p.StartInfo.FileName = ".\\langen.exe";
                    p.StartInfo.Arguments = "";
                    p.StartInfo.WindowStyle = ProcessWindowStyle.Minimized;
                    p.Start();
                    p.WaitForExit();                     //Wait the registery editing
                    delay(1000);
                    t.Abort();
                    var s = new Settings("1");
                    s.ShowDialog();
                    t = new Thread(new ThreadStart(SplashScreen));
                    t.Start();

                    delay(100);
                }

                delay(300);

                #endregion

                #region Update System

                object u = key.GetValue("UpdateStart", null);
                if (u != null)
                {
                    string utlu = key.GetValue("UpdateStart").ToString();
                    if (utlu == "1")
                    {
                        string noco = "0";

                        int Out;
                        if (InternetGetConnectedState(out Out, 0) == true) noco = "0";
                        else noco = "1";

                        if (noco == "1")
                        {
                            var s = new nonet();
                            t.Abort();
                            s.ShowDialog();
                            t = new Thread(new ThreadStart(SplashScreen));
                            t.Start();
                        }
                        else
                        {
                            if (File.Exists(".\\temp\\gitversion.txt"))    //Check if the file exist
                            {
                                File.Delete(".\\temp\\gitversion.txt");    //Delete it if exist
                            }
                            if (File.Exists(".\\fr.resx"))    //Check if the file exist
                            {
                                File.Delete(".\\fr.resx");    //Delete it if exist
                            }
                            if (File.Exists(".\\en.resx"))    //Check if the file exist
                            {
                                File.Delete(".\\en.resx");    //Delete it if exist
                            }

                            using (var client = new WebClient())
                            {
                                client.DownloadFile("https://raw.githubusercontent.com/STY1001/Unowhy-Tools/master/Update/Version.txt", ".\\temp\\gitversion.txt");     //Download Version file
                                client.DownloadFile("https://raw.githubusercontent.com/STY1001/Unowhy-Tools/master/Unowhy%20Tools/Lang/fr.resx", ".\\fr.resx");         //Update Languages
                                client.DownloadFile("https://raw.githubusercontent.com/STY1001/Unowhy-Tools/master/Unowhy%20Tools/Lang/en.resx", ".\\en.resx");         //Update Languages
                            }

                            string gitver = System.IO.File.ReadAllText(".\\temp\\gitversion.txt");      //Convert text to string
                            string progver = System.IO.File.ReadAllText(".\\version.txt");

                            int gitint = Convert.ToInt32(gitver);       //Convert string to int
                            int progint = Convert.ToInt32(progver);

                            if (progint < gitint)        //Check if there is a new vertion of UT
                            {
                                var s = new newver();
                                t.Abort();
                                s.ShowDialog();
                                t = new Thread(new ThreadStart(SplashScreen));
                                t.Start();
                            }
                            else
                            {

                            }
                        }
                    }
                }
                else
                {

                }

                #endregion

                #region Collect Infos

                // Collecting PC Info and compress to txt
                Process pci = new Process();
                pci.StartInfo.FileName = ".\\getpcinfo.exe";
                pci.StartInfo.Arguments = "";
                pci.StartInfo.WindowStyle = ProcessWindowStyle.Minimized;
                pci.Start();
                pci.WaitForExit();

                Process pci2 = new Process();
                pci2.StartInfo.FileName = ".\\getsoftinfo.exe";
                pci2.StartInfo.Arguments = "";
                pci2.StartInfo.WindowStyle = ProcessWindowStyle.Minimized;
                pci2.Start();
                pci2.WaitForExit();

                Process pci3 = new Process();
                pci3.StartInfo.FileName = ".\\getuserinfo.exe";
                pci3.StartInfo.Arguments = "";
                pci3.StartInfo.WindowStyle = ProcessWindowStyle.Minimized;
                pci3.Start();
                pci3.WaitForExit();

                string filePath = ".\\temp\\pcname.txt";
                int lineNumber = 1;
                int lineNumber2 = 2;
                int lineNumber4 = 4;
                int lineNumber6 = 6;
                StreamReader inputFile = new StreamReader(filePath);

                for (int i = 1; i < lineNumber; i++)
                {
                    inputFile.ReadLine();
                }
                string hnpcn = inputFile.ReadLine();

                filePath = ".\\temp\\mf.txt";
                inputFile = new StreamReader(filePath);

                for (int i = 1; i < lineNumber2; i++)
                {
                    inputFile.ReadLine();
                }
                string mf = inputFile.ReadLine();

                filePath = ".\\temp\\model.txt";
                inputFile = new StreamReader(filePath);

                for (int i = 1; i < lineNumber2; i++)
                {
                    inputFile.ReadLine();
                }
                string model = inputFile.ReadLine();

                filePath = ".\\temp\\os.txt";
                inputFile = new StreamReader(filePath);

                for (int i = 1; i < lineNumber2; i++)
                {
                    inputFile.ReadLine();
                }
                string os = inputFile.ReadLine();

                filePath = ".\\temp\\ene.txt";
                inputFile = new StreamReader(filePath);

                for (int i = 1; i < lineNumber2; i++)
                {
                    inputFile.ReadLine();
                }
                string ene = inputFile.ReadLine();

                filePath = ".\\temp\\ifp.txt";
                inputFile = new StreamReader(filePath);

                for (int i = 1; i < lineNumber2; i++)
                {
                    inputFile.ReadLine();
                }
                string ifp = inputFile.ReadLine();

                filePath = ".\\temp\\username.txt";
                inputFile = new StreamReader(filePath);

                for (int i = 1; i < lineNumber; i++)
                {
                    inputFile.ReadLine();
                }
                string un = inputFile.ReadLine();

                filePath = ".\\temp\\shell.txt";
                inputFile = new StreamReader(filePath);

                for (int i = 1; i < lineNumber; i++)
                {
                    inputFile.ReadLine();
                }
                string sk = inputFile.ReadLine();

                filePath = ".\\temp\\hsmst.txt";
                inputFile = new StreamReader(filePath);

                for (int i = 1; i < lineNumber; i++)
                {
                    inputFile.ReadLine();
                }
                string hsmst = inputFile.ReadLine();

                filePath = ".\\temp\\rs.txt";
                inputFile = new StreamReader(filePath);

                for (int i = 1; i < lineNumber4; i++)
                {
                    inputFile.ReadLine();
                }
                string rss = inputFile.ReadLine();

                filePath = ".\\temp\\azure.txt";
                inputFile = new StreamReader(filePath);

                for (int i = 1; i < lineNumber6; i++)
                {
                    inputFile.ReadLine();
                }
                string ass = inputFile.ReadLine();

                string finalinfotxt = ".\\fullpcinfo.txt";
                using (StreamWriter pcinfotxt = File.CreateText(finalinfotxt))
                {
                    pcinfotxt.WriteLine(hnpcn);
                    pcinfotxt.WriteLine(mf);
                    pcinfotxt.WriteLine(model);
                    pcinfotxt.WriteLine(ene);
                    pcinfotxt.WriteLine(ifp);
                    pcinfotxt.WriteLine(os);
                    pcinfotxt.WriteLine(un);
                }

                string finalsofttxt = ".\\fullsoftinfo.txt";
                using (StreamWriter softinfotxt = File.CreateText(finalsofttxt))
                {

                    softinfotxt.WriteLine(sk);
                    softinfotxt.WriteLine(hsmst);
                    softinfotxt.WriteLine(rss);
                    softinfotxt.WriteLine(ass);
                }

                #endregion
            }

            InitializeComponent();

            if (checkAdmin())
            {
                #region Debug Mode Visibility

                if (File.Exists("debug"))
                {
                    debuglab.Visible = true;
                    debshell.Visible = true;
                    debhme.Visible = true;
                    debhmr.Visible = true;
                    debhms.Visible = true;
                    debreagentc.Visible = true;
                    debazure.Visible = true;
                    debuser.Visible = true;
                    debti.Visible = true;
                    debent.Visible = true;
                    debadmin.Visible = true;
                    debwhe.Visible = true;
                    debbim.Visible = true;
                }

                #endregion

                langswitch();
                debuserid(userpath);
                check();
                changeswitch();

                //Go to foreground
                this.WindowState = FormWindowState.Minimized;
                this.Show();
                this.WindowState = FormWindowState.Normal;
            }
            t.Abort();
        }

        #region Custom Function

        #region Lang System

        //Lang System

        public void langswitch()
        {
            #region Check Language 

            //Check the current saved language

            RegistryKey utl = Registry.CurrentUser.OpenSubKey(@"Software\STY1001\Unowhy Tools", false);
            string utls = utl.GetValue("Lang").ToString();

            string enresx = @".\en.resx";
            string frresx = @".\fr.resx";
            //Chose the ResX file
            if (utls == "EN") resxFile = enresx;    //English   
            else resxFile = frresx;               //French

            #endregion

            #region Language Apply

            ResXResourceSet resxSet = new ResXResourceSet(resxFile);

            //Apply Language

            starthis.Text = resxSet.GetString("starthis");
            stophis.Text = resxSet.GetString("stophis");
            enhis.Text = resxSet.GetString("enhis");
            dishis.Text = resxSet.GetString("dishis");
            delhis.Text = resxSet.GetString("delhis");
            delhism.Text = resxSet.GetString("delhism");
            delcat.Text = resxSet.GetString("delcat");
            repaircat.Text = resxSet.GetString("repaircat");
            servicecat.Text = resxSet.GetString("servicecat");
            shell.Text = resxSet.GetString("shell");
            fixboot.Text = resxSet.GetString("fixboot");
            ent.Text = resxSet.GetString("ent");
            delti.Text = resxSet.GetString("delti");
            about.Text = resxSet.GetString("about");
            settings.Text = resxSet.GetString("settings");
            delridf.Text = resxSet.GetString("delridf");
            winre.Text = resxSet.GetString("winre");
            pcname.Text = resxSet.GetString("pcname");
            cuscat.Text = resxSet.GetString("cuscat");
            deloem.Text = resxSet.GetString("deloem");
            entf.Text = resxSet.GetString("delentf");
            pcinfo.Text = resxSet.GetString("pcinfo");
            admin.Text = resxSet.GetString("admin");
            aadleave.Text = resxSet.GetString("aadleave");
            adduser.Text = resxSet.GetString("adduser");
            adminset.Text = resxSet.GetString("adminset");
            psbr.Text = resxSet.GetString("psdrv");
            drivercat.Text = resxSet.GetString("drvcat");
            delhismserv.Text = resxSet.GetString("delhismserv");
            dismbr.Text = resxSet.GetString("dismdrv");
            enwhe.Text = resxSet.GetString("enwhe");
            guide.Text = resxSet.GetString("guide");
            opencmd.Text = resxSet.GetString("opencmd");
            unprog.Text = resxSet.GetString("unprog");
            opengp.Text = resxSet.GetString("opengp");
            openreg.Text = resxSet.GetString("openreg");
            opentask.Text = resxSet.GetString("opentask");
            bootim.Text = resxSet.GetString("bootim");
            string ver = Unowhy_Tools.Properties.Resources.Version.ToString();
            version.Text = ver;


            #endregion
        }

        #endregion

        #region Wait Func

        //Wait fonc

        private static void delay(int Time_delay)
        {
            int i = 0;
            System.Timers.Timer _delayTimer = new System.Timers.Timer();
            _delayTimer.Interval = Time_delay;
            _delayTimer.AutoReset = false;
            _delayTimer.Elapsed += (s, args) => i = 1;
            _delayTimer.Start();
            while (i == 0) { };
        }

        #endregion

        #region Btn Enabled Custom

        private void ebtn(Control btn)
        {
            btn.Enabled = true;
            btn.ForeColor = Color.White;
        }

        private void dbtn(Control btn)
        {
            btn.Enabled = false;
            btn.ForeColor = Color.Gray;
        }

        #endregion

        #region Other Func

        public void checkbootim()
        {
            if (debbim.Text == "true")
            {
                dbtn(bootim);
            }
            else
            {
                ebtn(bootim);
            }
        }

        public void checkwhe()
        {
            if (debwhe.Text == "true")
            {
                dbtn(enwhe);
            }
            else
            {
                ebtn(enwhe);
            }
        }

        public void debuserid(string iduserpath)
        {

            string filePath = $"{iduserpath}\\Unowhy Tools\\temp\\realid.txt";
            int lineNumber = 1;
            StreamReader inputFile = new StreamReader(filePath);

            for (int i = 1; i < lineNumber; i++)
            {
                inputFile.ReadLine();
            }
            string nameid = inputFile.ReadLine();

            if (nameid.Contains("AzureAD") == true)
            {
                string filePath2 = $"{iduserpath}\\Unowhy Tools\\temp\\compuser.txt";
                int lineNumber2 = 1;
                StreamReader inputFile2 = new StreamReader(filePath2);

                for (int i = 1; i < lineNumber2; i++)
                {
                    inputFile2.ReadLine();
                }
                string nameid2 = inputFile2.ReadLine();
                debuser.Text = nameid2;
            }
            else
            {
                string filePath2 = $"{iduserpath}\\Unowhy Tools\\temp\\user.txt";
                int lineNumber2 = 1;
                StreamReader inputFile2 = new StreamReader(filePath2);

                for (int i = 1; i < lineNumber2; i++)
                {
                    inputFile2.ReadLine();
                }
                string nameid2 = inputFile2.ReadLine();
                debuser.Text = nameid2;
            }
        }

        public void checkazure()
        {
            if (debazure.Text.Contains("NO") == true)
            {
                dbtn(aadleave);
            }
        }

        public void checkfolder()
        {
            if (Directory.Exists("C:\\ProgramData\\RIDF") == false)
            {
                dbtn(delridf);
            }

            if (Directory.Exists("C:\\ProgramData\\ENT") == false)
            {
                dbtn(entf);
            }

            if (Directory.Exists("C:\\Windows\\sysnative\\OEM") == false)
            {
                dbtn(deloem);
            }

            if (Directory.Exists("C:\\Program Files\\Unowhy\\TO_INSTALL") == false)
            {
                dbtn(delti);
            }

            if (Directory.Exists("C:\\Program Files\\Unowhy\\HiSqool Manager") == false)
            {
                dbtn(delhism);
            }

            if (Directory.Exists("C:\\Program Files\\Unowhy\\HiSqool") == false)
            {
                dbtn(delhis);
            }

            
        }

        public void checkhism()
        {
            if (debhme.Text == "true")
            {
                if (debhmr.Text == "true")
                {
                    dbtn(starthis);
                    ebtn(stophis);
                }
                else
                {
                    dbtn(stophis);
                    ebtn(starthis);
                }

                if (debhms.Text.Contains("Automatic") == true)
                {
                    dbtn(enhis);
                    ebtn(dishis);
                }
                else
                {
                    dbtn(starthis);
                    dbtn(stophis);
                    ebtn(enhis);
                    dbtn(dishis);
                }
            }
            else
            {
                dbtn(dishis);
                dbtn(enhis);
                dbtn(stophis);
                dbtn(starthis);
                dbtn(delhismserv);
            }
        }

        public void checkshell()
        {
            if (debshell.Text.Contains("explorer.exe") == true)
            {
                dbtn(shell);
            }
            else
            {
                ebtn(shell);
            }
        }

        public void checkadmin()
        {
            if (debadmin.Text == "true")
            {
                dbtn(admin);
            }
            else
            {
                ebtn(admin);
            }
        }

        public void checkent()
        {
            if (debent.Text == "true")
            {
                ebtn(ent);
            }
            else
            {
                dbtn(ent);
            }
        }

        public void checkti()
        {
            if (debti.Text == "true")
            {
                ebtn(fixboot);
                dbtn(delti);
            }
            else
            {
                dbtn(fixboot);
                ebtn(delti);
            }
        }

        public void check()
        {
            string filePath2 = ".\\fullsoftinfo.txt";
            int lineNumbers2 = 1;
            StreamReader inputFile2 = new StreamReader(filePath2);

            for (int i = 1; i < lineNumbers2; i++)
            {
                inputFile2.ReadLine();
            }
            debshell.Text = inputFile2.ReadLine();

            lineNumbers2 = 1;

            for (int i = 1; i < lineNumbers2; i++)
            {
                inputFile2.ReadLine();
            }
            debhms.Text = inputFile2.ReadLine();

            lineNumbers2 = 1;

            for (int i = 1; i < lineNumbers2; i++)
            {
                inputFile2.ReadLine();
            }
            debreagentc.Text = inputFile2.ReadLine();

            lineNumbers2 = 1;

            for (int i = 1; i < lineNumbers2; i++)
            {
                inputFile2.ReadLine();
            }
            debazure.Text = inputFile2.ReadLine();

            if (File.ReadAllText(".\\temp\\entuser.txt").Contains("ENT"))
            {
                debent.Text = "true";
            }
            else
            {
                debent.Text = "false";
            }

            if (serviceExists("HiSqoolManager"))
            {
                debhme.Text = "true";

                ServiceController sc = new ServiceController();
                sc.ServiceName = "HiSqoolManager";

                if (sc.Status == ServiceControllerStatus.Running)
                {
                    debhmr.Text = "true";
                }
                else
                {
                    debhmr.Text = "false";
                }

                if (debhms.Text.Contains("Automatic") == true)
                {
                    debhms.Text = "Automatic";
                }
                else
                {
                    debhms.Text = "Disabled";
                }
            }
            else
            {
                debhme.Text = "false";
                debhmr.Text = "none";
                debhms.Text = "none";
            }

            if (File.ReadAllText(".\\temp\\adminusers.txt").Contains(debuser.Text))
            {
                debadmin.Text = "true";
            }
            else
            {
                debadmin.Text= "false";
            }

            DirectoryInfo dir = new DirectoryInfo("C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Startup");
            FileInfo[] files = dir.GetFiles("silent_" + "*.*");
            if (files.Length > 0)
            {
                debti.Text = "true";
            }
            else
            {
                debti.Text= "false";
            }

            RegistryKey whe1 = Registry.LocalMachine.OpenSubKey("SOFTWARE\\Policies\\Microsoft\\PassportForWork");
            RegistryKey whe2 = Registry.LocalMachine.OpenSubKey("SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\WinBio\\Credential Provider");
            RegistryKey whe3 = Registry.LocalMachine.OpenSubKey("SOFTWARE\\Policies\\Microsoft\\PassportForWork\\DynamicLock");
            if (whe1 == null || /*whe2 == null ||*/ whe3 == null)
            {
                debwhe.Text = "false";
            }
            else
            {
                string val5 = whe3.GetValue("DynamicLock").ToString();
                //string val2 = whe2.GetValue("Domain Accounts").ToString();
                string val1 = whe1.GetValue("Enabled").ToString();
                string val3 = whe1.GetValue("RequireSecurityDevice").ToString();
                //string val4 = whe1.GetValue("UseCertificateForOnPremAuth").ToString();

                if(val1 == null || val3 == null || val5 == null)
                {
                    debwhe.Text= "false";
                }
                else
                {
                    if (val1.Contains("1") && /*val2.Contains("1") &&*/ val3.Contains("1") && /*val4.Contains("1") &&*/ val5.Contains("1"))
                    {
                        debwhe.Text = "true";
                    }
                    else
                    {
                        debwhe.Text = "false";
                    }
                }
            }

            RegistryKey bim1 = Registry.LocalMachine.OpenSubKey("SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\bootim.exe");
            if(bim1 == null)
            {
                debbim.Text = "true";
            }
            else
            {
                debbim.Text = "false";
            }
        }

        public void changeswitch()
        {
            ebtn(delhis);
            ebtn(delhism);
            ebtn(deloem);
            ebtn(delridf);
            ebtn(dishis);
            ebtn(enhis);
            ebtn(stophis);
            ebtn(starthis);
            ebtn(ent);
            ebtn(entf);
            ebtn(delti);
            ebtn(aadleave);
            ebtn(pcname);
            ebtn(admin);
            ebtn(adminset);
            ebtn(adduser);
            ebtn(winre);
            ebtn(fixboot);
            ebtn(delhismserv);
            ebtn(psbr);
            ebtn(shell);
            ebtn(enwhe);
            ebtn(dismbr);
            ebtn(bkcloud);
            ebtn(bootim);

            checkhism();
            checkazure();
            checkadmin();
            checkent();
            checkti();
            checkfolder();
            checkwhe();
            checkbootim();
            checkshell();
        }

        #endregion

        #endregion

        #region Buttons Action

        private void starthis_Click(object sender, EventArgs e)
        {
            string msg = starthis.Text;
            dialog d = new dialog(msg);
            d.ShowDialog();
            if (d.DialogResult.Equals(DialogResult.Yes))
            {
                TaskbarManager.Instance.SetProgressState(TaskbarProgressBarState.Indeterminate);
                Thread t = new Thread(new ThreadStart(WaitScreen));               //Splash Screen
                t.Start();
                                                                      // Start HiSqool Manager  
                Process p = new Process();
                p.StartInfo.FileName = ".\\starthis.exe";
                p.StartInfo.Arguments = "";
                p.StartInfo.WindowStyle = ProcessWindowStyle.Minimized;
                p.Start();
                p.WaitForExit();
                debhmr.Text = "true";
                debhms.Text = "Automatic";
                changeswitch();
                t.Abort();
                TaskbarManager.Instance.SetProgressState(TaskbarProgressBarState.NoProgress);
            }
                      
        }

        private void stophis_Click(object sender, EventArgs e)
        {
            string msg = stophis.Text;
            dialog d = new dialog(msg);
            d.ShowDialog();
            if (d.DialogResult.Equals(DialogResult.Yes))
            {
                TaskbarManager.Instance.SetProgressState(TaskbarProgressBarState.Indeterminate);
                Thread t = new Thread(new ThreadStart(WaitScreen));               //Splash Screen
                t.Start();
                                                                      // Stop HiSqool Manager
                Process p = new Process();
                p.StartInfo.FileName = ".\\stophis.exe";
                p.StartInfo.Arguments = "";
                p.StartInfo.WindowStyle = ProcessWindowStyle.Minimized;
                p.Start();
                p.WaitForExit();
                debhmr.Text = "false";
                debhms.Text = "Automatic";
                changeswitch();
                t.Abort();
                TaskbarManager.Instance.SetProgressState(TaskbarProgressBarState.NoProgress);
            }
        }

        private void enhis_Click(object sender, EventArgs e)
        {
            string msg = enhis.Text;
            dialog d = new dialog(msg);
            d.ShowDialog();
            if (d.DialogResult.Equals(DialogResult.Yes))
            {
                TaskbarManager.Instance.SetProgressState(TaskbarProgressBarState.Indeterminate);
                Thread t = new Thread(new ThreadStart(WaitScreen));               //Splash Screen
                t.Start(); 
                                                                     // Enable HiSqool Manager
                Process p = new Process();
                p.StartInfo.FileName = ".\\enhis.exe";
                p.StartInfo.Arguments = "";
                p.StartInfo.WindowStyle = ProcessWindowStyle.Minimized;
                p.Start();
                p.WaitForExit();
                debhms.Text = "Automatic";
                debhmr.Text = "true";
                changeswitch();
                t.Abort();
                TaskbarManager.Instance.SetProgressState(TaskbarProgressBarState.NoProgress);
            }
        }

        private void dishis_Click(object sender, EventArgs e)
        {
            string msg = dishis.Text;
            dialog d = new dialog(msg);
            d.ShowDialog();
            if (d.DialogResult.Equals(DialogResult.Yes))
            {
                TaskbarManager.Instance.SetProgressState(TaskbarProgressBarState.Indeterminate);
                Thread t = new Thread(new ThreadStart(WaitScreen));               //Splash Screen
                t.Start();
                                                                           // Disable HiSqool Manager
                Process p = new Process();
                p.StartInfo.FileName = ".\\dishis.exe";
                p.StartInfo.Arguments = "";
                p.StartInfo.WindowStyle = ProcessWindowStyle.Minimized;
                p.Start();
                p.WaitForExit();
                debhms.Text = "Disabled";
                debhmr.Text = "false";
                changeswitch();
                t.Abort();
                TaskbarManager.Instance.SetProgressState(TaskbarProgressBarState.NoProgress);
            }
        }

        private void delhis_Click(object sender, EventArgs e)
        {
            string msg = delhis.Text;
            dialog d = new dialog(msg);
            d.ShowDialog();
            if (d.DialogResult.Equals(DialogResult.Yes))
            {
                TaskbarManager.Instance.SetProgressState(TaskbarProgressBarState.Indeterminate);
                Thread t = new Thread(new ThreadStart(WaitScreen));               //Splash Screen
                t.Start();
                                                                          // Launch Uninstaller of HiSqool
                Process p = new Process();
                p.StartInfo.FileName = "C:\\Program Files\\Unowhy\\HiSqool\\Uninstall Hisqool.exe";
                p.StartInfo.Arguments = "";
                p.StartInfo.WindowStyle = ProcessWindowStyle.Minimized;
                p.Start();
                p.WaitForExit();
                changeswitch();
                t.Abort();
                TaskbarManager.Instance.SetProgressState(TaskbarProgressBarState.NoProgress);
            }
        }

        private void delhism_Click(object sender, EventArgs e)
        {
            string msg = delhism.Text;
            dialog d = new dialog(msg);
            d.ShowDialog();
            if (d.DialogResult.Equals(DialogResult.Yes))
            {
                TaskbarManager.Instance.SetProgressState(TaskbarProgressBarState.Indeterminate);
                Thread t = new Thread(new ThreadStart(WaitScreen));               //Splash Screen
                t.Start();
                                                                         // Remove HiSqool Manager folder
                Process p = new Process();
                p.StartInfo.FileName = ".\\rmdirhismgr.exe";
                p.StartInfo.Arguments = "";
                p.StartInfo.WindowStyle = ProcessWindowStyle.Minimized;
                p.Start();
                p.WaitForExit();
                debhme.Text = "false";
                changeswitch();
                t.Abort();
                TaskbarManager.Instance.SetProgressState(TaskbarProgressBarState.NoProgress);
            }
        }

        private void shell_Click(object sender, EventArgs e)
        {
            string msg = shell.Text;
            dialog d = new dialog(msg);
            d.ShowDialog();
            if (d.DialogResult.Equals(DialogResult.Yes))
            {
                TaskbarManager.Instance.SetProgressState(TaskbarProgressBarState.Indeterminate);
                Thread t = new Thread(new ThreadStart(WaitScreen));               //Splash Screen
                t.Start();
                                                                               // Change Shell value
                Process p = new Process();
                p.StartInfo.FileName = ".\\shell.exe";
                p.StartInfo.Arguments = "";
                p.StartInfo.WindowStyle = ProcessWindowStyle.Minimized;
                p.Start();
                p.WaitForExit();
                debshell.Text = "explorer.exe";
                changeswitch();
                t.Abort();
                TaskbarManager.Instance.SetProgressState(TaskbarProgressBarState.NoProgress);
            }
        }

        private void delent_Click(object sender, EventArgs e)
        {
            string msg = ent.Text;
            dialog d = new dialog(msg);
            d.ShowDialog();
            if (d.DialogResult.Equals(DialogResult.Yes))
            {
                TaskbarManager.Instance.SetProgressState(TaskbarProgressBarState.Indeterminate);
                Thread t = new Thread(new ThreadStart(WaitScreen));               //Splash Screen
                t.Start();
                                                                                // Delete ENT account
                Process p = new Process();
                p.StartInfo.FileName = ".\\delent.exe";
                p.StartInfo.Arguments = "";
                p.StartInfo.WindowStyle = ProcessWindowStyle.Minimized;
                p.Start();
                p.WaitForExit();
                debent.Text = "false";
                changeswitch();
                t.Abort();
                TaskbarManager.Instance.SetProgressState(TaskbarProgressBarState.NoProgress);
            }
        }

        private void about_Click(object sender, EventArgs e)
        {
            var a = new About();    //Launch About form
            a.ShowDialog();
        }

        private void fixboot_Click(object sender, EventArgs e)
        {
            string msg = fixboot.Text;
            dialog d = new dialog(msg);
            d.ShowDialog();
            if (d.DialogResult.Equals(DialogResult.Yes))
            {
                TaskbarManager.Instance.SetProgressState(TaskbarProgressBarState.Indeterminate);
                Thread t = new Thread(new ThreadStart(WaitScreen));               //Splash Screen
                t.Start();
                                                                                //Delete silent_*.vbs.lnk
                Process p = new Process();
                p.StartInfo.FileName = ".\\fixti.exe";
                p.StartInfo.Arguments = "";
                p.StartInfo.WindowStyle = ProcessWindowStyle.Minimized;
                p.Start();
                p.WaitForExit();
                debti.Text = "false";
                changeswitch();
                t.Abort();
                TaskbarManager.Instance.SetProgressState(TaskbarProgressBarState.NoProgress);
            }
        }

        private void delti_Click(object sender, EventArgs e)
        {
            string msg = delti.Text;
            dialog d = new dialog(msg);
            d.ShowDialog();
            if (d.DialogResult.Equals(DialogResult.Yes))
            {
                TaskbarManager.Instance.SetProgressState(TaskbarProgressBarState.Indeterminate);
                Thread t = new Thread(new ThreadStart(WaitScreen));               //Splash Screen
                t.Start();
                                                                                //Remove "TO_INSTALL"
                Process p = new Process();
                p.StartInfo.FileName = ".\\rdti.exe";
                p.StartInfo.Arguments = "";
                p.StartInfo.WindowStyle = ProcessWindowStyle.Minimized;
                p.Start();
                p.WaitForExit();
                changeswitch();
                t.Abort();
                TaskbarManager.Instance.SetProgressState(TaskbarProgressBarState.NoProgress);
            }
        }

        private void settings_Click(object sender, EventArgs e)
        {
            var s = new Settings("0");     //Show settings
            s.ShowDialog();
            delay(1000);
            langswitch();
        }

        private void delridf_Click(object sender, EventArgs e)
        {
            string msg = delridf.Text;
            dialog d = new dialog(msg);
            d.ShowDialog();
            if (d.DialogResult.Equals(DialogResult.Yes))
            {
                TaskbarManager.Instance.SetProgressState(TaskbarProgressBarState.Indeterminate);
                Thread t = new Thread(new ThreadStart(WaitScreen));               //Splash Screen
                t.Start();
                                                                               //Delete "RIDF"
                Process p = new Process();
                p.StartInfo.FileName = ".\\delridf.exe";
                p.StartInfo.Arguments = "";
                p.StartInfo.WindowStyle = ProcessWindowStyle.Minimized;
                p.Start();
                p.WaitForExit();
                changeswitch();
                t.Abort();
                TaskbarManager.Instance.SetProgressState(TaskbarProgressBarState.NoProgress);
            }
        }

        private void winre_Click(object sender, EventArgs e)
        {
            /*
            string msg = winre.Text;
            dialog d = new dialog(msg);
            d.ShowDialog();
            if (d.DialogResult.Equals(DialogResult.Yes))
            {
                TaskbarManager.Instance.SetProgressState(TaskbarProgressBarState.Indeterminate);
                Thread t = new Thread(new ThreadStart(WaitScreen));               //Splash Screen
                t.Start();
                                                                               //Enable reagentc
                Process p = new Process();
                p.StartInfo.FileName = ".\\winre.exe";
                p.StartInfo.Arguments = "";
                p.StartInfo.WindowStyle = ProcessWindowStyle.Minimized;
                p.Start();
                p.WaitForExit();
                debreagentc.Text = "Enabled";
                changeswitch();
                t.Abort();
                TaskbarManager.Instance.SetProgressState(TaskbarProgressBarState.NoProgress);
            }
            */

            var wre = new winreset();
            wre.ShowDialog();
        }

        private void pcname_Click(object sender, EventArgs e)
        {
            var pcn = new PCName();     // Change the Name of PC
            pcn.ShowDialog();
        }

        private void deloem_Click(object sender, EventArgs e)
        {
            string msg = deloem.Text;
            dialog d = new dialog(msg);
            d.ShowDialog();
            if (d.DialogResult.Equals(DialogResult.Yes))
            {
                TaskbarManager.Instance.SetProgressState(TaskbarProgressBarState.Indeterminate);
                Thread t = new Thread(new ThreadStart(WaitScreen));               //Splash Screen
                t.Start();
                                                                               // Delete OEM folder
                Process p = new Process();
                p.StartInfo.FileName = ".\\deloem.exe";
                p.StartInfo.Arguments = "";
                p.StartInfo.WindowStyle = ProcessWindowStyle.Minimized;
                p.Start();
                p.WaitForExit();
                checkfolder();
                t.Abort();
                TaskbarManager.Instance.SetProgressState(TaskbarProgressBarState.NoProgress);
            }
        }

        private void logo_Click(object sender, EventArgs e)
        {
            // Presentation Mode

            var p = new pmod();
            p.Show();
        }

        private void delentf_Click(object sender, EventArgs e)
        {
            string msg = entf.Text;
            dialog d = new dialog(msg);
            d.ShowDialog();
            if (d.DialogResult.Equals(DialogResult.Yes))
            {
                TaskbarManager.Instance.SetProgressState(TaskbarProgressBarState.Indeterminate);
                Thread t = new Thread(new ThreadStart(WaitScreen));               //Splash Screen
                t.Start();
                                                                              // Delete ENT folder
                Process p = new Process();
                p.StartInfo.FileName = ".\\delentf.exe";
                p.StartInfo.Arguments = "";
                p.StartInfo.WindowStyle = ProcessWindowStyle.Minimized;
                p.Start();
                p.WaitForExit();
                checkfolder();
                t.Abort();
                TaskbarManager.Instance.SetProgressState(TaskbarProgressBarState.NoProgress);
            }
        }

        private void pcinfo_Click(object sender, EventArgs e)
        {
            var pci = new PCInfo();
            pci.ShowDialog();
        }

        private void aadleave_Click(object sender, EventArgs e)
        {
            string msg = aadleave.Text;
            dialog d = new dialog(msg);
            d.ShowDialog();
            if (d.DialogResult.Equals(DialogResult.Yes))
            {
                TaskbarManager.Instance.SetProgressState(TaskbarProgressBarState.Indeterminate);
                Thread t = new Thread(new ThreadStart(WaitScreen));               //Splash Screen
                t.Start();
                                                                                 // Disconnect Azure AD domain from PC
                Process p = new Process();
                p.StartInfo.FileName = ".\\azureleave.exe";
                p.StartInfo.Arguments = "";
                p.StartInfo.WindowStyle = ProcessWindowStyle.Minimized;
                p.Start();
                p.WaitForExit();
                debazure.Text = "NO";
                changeswitch();
                t.Abort();
                TaskbarManager.Instance.SetProgressState(TaskbarProgressBarState.NoProgress);
            }
        }

        private void admin_Click(object sender, EventArgs e)
        {
            string msg = admin.Text;
            dialog d = new dialog(msg);
            d.ShowDialog();
            if (d.DialogResult.Equals(DialogResult.Yes))
            {
                TaskbarManager.Instance.SetProgressState(TaskbarProgressBarState.Indeterminate);
                Thread t = new Thread(new ThreadStart(WaitScreen));               //Splash Screen
                t.Start();
                
                string user = debuser.Text;

                string arg = ($"localgroup Administrateurs /add \"{user}\"");
                                                                           // Set admin
                Process p = new Process();
                p.StartInfo.FileName = "net";
                p.StartInfo.Arguments = arg;
                p.StartInfo.WindowStyle = ProcessWindowStyle.Minimized;
                p.Start();
                p.WaitForExit();
                t.Abort();
                var f = new reboot();
                f.ShowDialog();
                debadmin.Text = "true";
                changeswitch();
                TaskbarManager.Instance.SetProgressState(TaskbarProgressBarState.NoProgress);
            }
        }

        private void adduser_Click(object sender, EventArgs e)
        {
            var u = new Adduser();     //Show Add user
            u.ShowDialog();
        }

        private void adminset_Click(object sender, EventArgs e)
        {
            var a = new AdminSet();     //Show Admin Settings
            a.ShowDialog();
        }

        private void delserv_Click(object sender, EventArgs e)
        {
            string msg = delhismserv.Text;
            dialog d = new dialog(msg);
            d.ShowDialog();
            if (d.DialogResult.Equals(DialogResult.Yes))
            {
                TaskbarManager.Instance.SetProgressState(TaskbarProgressBarState.Indeterminate);
                Thread t = new Thread(new ThreadStart(WaitScreen));               //Splash Screen
                t.Start();
                                                                             // Del Serv Only
                Process p = new Process();
                p.StartInfo.FileName = ".\\delhismserv.exe";
                p.StartInfo.Arguments = "";
                p.StartInfo.WindowStyle = ProcessWindowStyle.Minimized;
                p.Start();
                p.WaitForExit();
                checkfolder();
                debhme.Text = "false";
                changeswitch();
                t.Abort();
                TaskbarManager.Instance.SetProgressState(TaskbarProgressBarState.NoProgress);
            }
        }

        private void psdrv_Click(object sender, EventArgs e)
        {
            var ps = new psdriver();
            ps.ShowDialog();
        }

        private void dismdrv_Click(object sender, EventArgs e)
        {
            var dism = new dismdriver();
            dism.ShowDialog();
        }

        private void opencmd_Click(object sender, EventArgs e)
        {
            System.Diagnostics.Process.Start("cmd.exe");
        }

        private void unprog_Click(object sender, EventArgs e)
        {
            System.Diagnostics.Process.Start("ms-settings:appsfeatures");
        }

        private void guide_Click(object sender, EventArgs e)
        {
            System.Diagnostics.Process.Start("https://github.com/STY1001/Unowhy-Tools/blob/master/GUIDE.md");
        }

        private void enwhe_Click(object sender, EventArgs e)
        {
            string msg = enwhe.Text;
            dialog d = new dialog(msg);
            d.ShowDialog();
            if (d.DialogResult.Equals(DialogResult.Yes))
            {
                TaskbarManager.Instance.SetProgressState(TaskbarProgressBarState.Indeterminate);
                Thread t = new Thread(new ThreadStart(WaitScreen));               //Splash Screen
                t.Start();
                                                                        //Enable winhelloent
                Process p = new Process();
                p.StartInfo.FileName = ".\\winhelloent.exe";
                p.StartInfo.Arguments = "";
                p.StartInfo.WindowStyle = ProcessWindowStyle.Minimized;
                p.Start();
                p.WaitForExit();
                debwhe.Text = "true";
                changeswitch();
                t.Abort();
                TaskbarManager.Instance.SetProgressState(TaskbarProgressBarState.NoProgress);
            }
        }

        private void bkcloud_Click(object sender, EventArgs e)
        {
            System.Diagnostics.Process.Start("https://hksty1001-my.sharepoint.com/:f:/g/personal/cloud_hksty1001_onmicrosoft_com/Ejk2S5pcwCFPnUxKDVQaUPoBpw-3IMAjuLYiJO_Fi-vsKQ?e=SAI4SS");
        }

        private void opengp_Click(object sender, EventArgs e)
        {
            System.Diagnostics.Process.Start("gpedit.msc");
        }

        private void openreg_Click(object sender, EventArgs e)
        {
            System.Diagnostics.Process.Start("regedit.exe");
        }

        private void opentask_Click(object sender, EventArgs e)
        {
            System.Diagnostics.Process.Start("taskmgr.exe");
        }
        private void bootim_Click(object sender, EventArgs e)
        {
            string msg = bootim.Text;
            dialog d = new dialog(msg);
            d.ShowDialog();
            if (d.DialogResult.Equals(DialogResult.Yes))
            {
                TaskbarManager.Instance.SetProgressState(TaskbarProgressBarState.Indeterminate);
                Thread t = new Thread(new ThreadStart(WaitScreen));               //Splash Screen
                t.Start();
                                                                    //Unpatch bootim
                Process p = new Process();
                p.StartInfo.FileName = ".\\bootim.exe";
                p.StartInfo.Arguments = "";
                p.StartInfo.WindowStyle = ProcessWindowStyle.Minimized;
                p.Start();
                p.WaitForExit();
                debbim.Text = "true";
                changeswitch();
                t.Abort();
                TaskbarManager.Instance.SetProgressState(TaskbarProgressBarState.NoProgress);
            }
        }

        private void debug_Click(object sender, EventArgs e)  // Enable all button (debug mode)
        {
            ebtn(delhis);
            ebtn(delhism);
            ebtn(deloem);
            ebtn(delridf);
            ebtn(dishis);
            ebtn(enhis);
            ebtn(stophis);
            ebtn(starthis);
            ebtn(ent);
            ebtn(entf);
            ebtn(delti);
            ebtn(aadleave);
            ebtn(pcname);
            ebtn(admin);
            ebtn(adminset);
            ebtn(adduser);
            ebtn(winre);
            ebtn(fixboot);
            ebtn(delhismserv);
            ebtn(psbr);
            ebtn(shell);
            ebtn(enwhe);
            ebtn(dismbr);
            ebtn(bkcloud);
            ebtn(bootim);
        }

        private void debugenable_Click(object sender, EventArgs e)  // Enable all button (debug mode)
        {
            string msg = "Debug Mode (Restart to apply)";
            dialog d = new dialog(msg);
            d.ShowDialog();
            if (d.DialogResult.Equals(DialogResult.Yes))
            {
                File.Create(".\\debug");
            }
        }

        #endregion

        #region Buttons Description

        private void desc_Clean(object sender, EventArgs e)
        {
            desc.Text = "";
        }

        private void desc_Hism(object sender, EventArgs e)
        {
            //Check the current saved language

            RegistryKey utl = Registry.CurrentUser.OpenSubKey(@"Software\STY1001\Unowhy Tools", false);
            string utls = utl.GetValue("Lang").ToString();

            string enresx = @".\en.resx";
            string frresx = @".\fr.resx";
            //Chose the ResX file
            if (utls == "EN") resxFile = enresx;    //English   
            else resxFile = frresx;                //French
            ResXResourceSet resxSet = new ResXResourceSet(resxFile);

            desc.Text = resxSet.GetString("deschism");
        }

        private void desc_Shell(object sender, EventArgs e)
        {
            //Check the current saved language

            RegistryKey utl = Registry.CurrentUser.OpenSubKey(@"Software\STY1001\Unowhy Tools", false);
            string utls = utl.GetValue("Lang").ToString();

            string enresx = @".\en.resx";
            string frresx = @".\fr.resx";
            //Chose the ResX file
            if (utls == "EN") resxFile = enresx;    //English   
            else resxFile = frresx;                //French
            ResXResourceSet resxSet = new ResXResourceSet(resxFile);

            desc.Text = resxSet.GetString("descshell");
        }

        private void desc_Fixti(object sender, EventArgs e)
        {
            //Check the current saved language

            RegistryKey utl = Registry.CurrentUser.OpenSubKey(@"Software\STY1001\Unowhy Tools", false);
            string utls = utl.GetValue("Lang").ToString();

            string enresx = @".\en.resx";
            string frresx = @".\fr.resx";
            //Chose the ResX file
            if (utls == "EN") resxFile = enresx;    //English   
            else resxFile = frresx;                //French
            ResXResourceSet resxSet = new ResXResourceSet(resxFile);

            desc.Text = resxSet.GetString("descstart");
        }

        private void desc_Winre(object sender, EventArgs e)
        {
            //Check the current saved language

            RegistryKey utl = Registry.CurrentUser.OpenSubKey(@"Software\STY1001\Unowhy Tools", false);
            string utls = utl.GetValue("Lang").ToString();

            string enresx = @".\en.resx";
            string frresx = @".\fr.resx";
            //Chose the ResX file
            if (utls == "EN") resxFile = enresx;    //English   
            else resxFile = frresx;                //French
            ResXResourceSet resxSet = new ResXResourceSet(resxFile);

            desc.Text = resxSet.GetString("descwinre");
        }

        private void desc_Ent(object sender, EventArgs e)
        {
            //Check the current saved language

            RegistryKey utl = Registry.CurrentUser.OpenSubKey(@"Software\STY1001\Unowhy Tools", false);
            string utls = utl.GetValue("Lang").ToString();

            string enresx = @".\en.resx";
            string frresx = @".\fr.resx";
            //Chose the ResX file
            if (utls == "EN") resxFile = enresx;    //English   
            else resxFile = frresx;                //French
            ResXResourceSet resxSet = new ResXResourceSet(resxFile);

            desc.Text = resxSet.GetString("descent");
        }

        private void desc_His(object sender, EventArgs e)
        {
            //Check the current saved language

            RegistryKey utl = Registry.CurrentUser.OpenSubKey(@"Software\STY1001\Unowhy Tools", false);
            string utls = utl.GetValue("Lang").ToString();

            string enresx = @".\en.resx";
            string frresx = @".\fr.resx";
            //Chose the ResX file
            if (utls == "EN") resxFile = enresx;    //English   
            else resxFile = frresx;                //French
            ResXResourceSet resxSet = new ResXResourceSet(resxFile);

            desc.Text = resxSet.GetString("deschisdel");
        }

        private void desc_Delhism(object sender, EventArgs e)
        {
            //Check the current saved language

            RegistryKey utl = Registry.CurrentUser.OpenSubKey(@"Software\STY1001\Unowhy Tools", false);
            string utls = utl.GetValue("Lang").ToString();

            string enresx = @".\en.resx";
            string frresx = @".\fr.resx";
            //Chose the ResX file
            if (utls == "EN") resxFile = enresx;    //English   
            else resxFile = frresx;                //French
            ResXResourceSet resxSet = new ResXResourceSet(resxFile);

            desc.Text = resxSet.GetString("deschismdel");
        }

        private void desc_Delti(object sender, EventArgs e)
        {
            //Check the current saved language

            RegistryKey utl = Registry.CurrentUser.OpenSubKey(@"Software\STY1001\Unowhy Tools", false);
            string utls = utl.GetValue("Lang").ToString();

            string enresx = @".\en.resx";
            string frresx = @".\fr.resx";
            //Chose the ResX file
            if (utls == "EN") resxFile = enresx;    //English   
            else resxFile = frresx;                //French
            ResXResourceSet resxSet = new ResXResourceSet(resxFile);

            desc.Text = resxSet.GetString("desctidel");
        }

        private void desc_Ridf(object sender, EventArgs e)
        {
            //Check the current saved language

            RegistryKey utl = Registry.CurrentUser.OpenSubKey(@"Software\STY1001\Unowhy Tools", false);
            string utls = utl.GetValue("Lang").ToString();

            string enresx = @".\en.resx";
            string frresx = @".\fr.resx";
            //Chose the ResX file
            if (utls == "EN") resxFile = enresx;    //English   
            else resxFile = frresx;                //French
            ResXResourceSet resxSet = new ResXResourceSet(resxFile);

            desc.Text = resxSet.GetString("descridf");
        }

        private void desc_Oem(object sender, EventArgs e)
        {
            //Check the current saved language

            RegistryKey utl = Registry.CurrentUser.OpenSubKey(@"Software\STY1001\Unowhy Tools", false);
            string utls = utl.GetValue("Lang").ToString();

            string enresx = @".\en.resx";
            string frresx = @".\fr.resx";
            //Chose the ResX file
            if (utls == "EN") resxFile = enresx;    //English   
            else resxFile = frresx;                //French
            ResXResourceSet resxSet = new ResXResourceSet(resxFile);

            desc.Text = resxSet.GetString("descdeloem");
        }

        private void desc_Entf(object sender, EventArgs e)
        {
            //Check the current saved language

            RegistryKey utl = Registry.CurrentUser.OpenSubKey(@"Software\STY1001\Unowhy Tools", false);
            string utls = utl.GetValue("Lang").ToString();

            string enresx = @".\en.resx";
            string frresx = @".\fr.resx";
            //Chose the ResX file
            if (utls == "EN") resxFile = enresx;    //English   
            else resxFile = frresx;                //French
            ResXResourceSet resxSet = new ResXResourceSet(resxFile);

            desc.Text = resxSet.GetString("descdelentf");
        }

        private void desc_PCN(object sender, EventArgs e)
        {
            //Check the current saved language

            RegistryKey utl = Registry.CurrentUser.OpenSubKey(@"Software\STY1001\Unowhy Tools", false);
            string utls = utl.GetValue("Lang").ToString();

            string enresx = @".\en.resx";
            string frresx = @".\fr.resx";
            //Chose the ResX file
            if (utls == "EN") resxFile = enresx;    //English   
            else resxFile = frresx;                //French
            ResXResourceSet resxSet = new ResXResourceSet(resxFile);

            desc.Text = resxSet.GetString("descpcname");
        }

        private void desc_Admin(object sender, EventArgs e)
        {
            //Check the current saved language

            RegistryKey utl = Registry.CurrentUser.OpenSubKey(@"Software\STY1001\Unowhy Tools", false);
            string utls = utl.GetValue("Lang").ToString();

            string enresx = @".\en.resx";
            string frresx = @".\fr.resx";
            //Chose the ResX file
            if (utls == "EN") resxFile = enresx;    //English   
            else resxFile = frresx;                //French
            ResXResourceSet resxSet = new ResXResourceSet(resxFile);

            desc.Text = resxSet.GetString("descadmin");
        }

        private void desc_logo(object sender, EventArgs e)
        {
            desc.Text = "Presentation Mode (Display all form of Unowhy Tools / Affiche tous les form. de Unowhy Tools)";
        }

        private void desc_Aadleave(object sender, EventArgs e)
        {
            //Check the current saved language

            RegistryKey utl = Registry.CurrentUser.OpenSubKey(@"Software\STY1001\Unowhy Tools", false);
            string utls = utl.GetValue("Lang").ToString();

            string enresx = @".\en.resx";
            string frresx = @".\fr.resx";
            //Chose the ResX file
            if (utls == "EN") resxFile = enresx;    //English   
            else resxFile = frresx;                //French
            ResXResourceSet resxSet = new ResXResourceSet(resxFile);

            desc.Text = resxSet.GetString("descaadleave");
        }

        private void desc_Adduser(object sender, EventArgs e)
        {
            //Check the current saved language

            RegistryKey utl = Registry.CurrentUser.OpenSubKey(@"Software\STY1001\Unowhy Tools", false);
            string utls = utl.GetValue("Lang").ToString();

            string enresx = @".\en.resx";
            string frresx = @".\fr.resx";
            //Chose the ResX file
            if (utls == "EN") resxFile = enresx;    //English   
            else resxFile = frresx;                //French
            ResXResourceSet resxSet = new ResXResourceSet(resxFile);

            desc.Text = resxSet.GetString("descadduser");
        }

        private void desc_Adminset(object sender, EventArgs e)
        {
            //Check the current saved language

            RegistryKey utl = Registry.CurrentUser.OpenSubKey(@"Software\STY1001\Unowhy Tools", false);
            string utls = utl.GetValue("Lang").ToString();

            string enresx = @".\en.resx";
            string frresx = @".\fr.resx";
            //Chose the ResX file
            if (utls == "EN") resxFile = enresx;    //English   
            else resxFile = frresx;                //French
            ResXResourceSet resxSet = new ResXResourceSet(resxFile);

            desc.Text = resxSet.GetString("descadminset");
        }

        private void desc_delserv(object sender, EventArgs e)
        {
            //Check the current saved language

            RegistryKey utl = Registry.CurrentUser.OpenSubKey(@"Software\STY1001\Unowhy Tools", false);
            string utls = utl.GetValue("Lang").ToString();

            string enresx = @".\en.resx";
            string frresx = @".\fr.resx";
            //Chose the ResX file
            if (utls == "EN") resxFile = enresx;    //English   
            else resxFile = frresx;                //French
            ResXResourceSet resxSet = new ResXResourceSet(resxFile);

            desc.Text = resxSet.GetString("descadminset");
        }

        private void desc_psbr(object sender, EventArgs e)
        {
            //Check the current saved language

            RegistryKey utl = Registry.CurrentUser.OpenSubKey(@"Software\STY1001\Unowhy Tools", false);
            string utls = utl.GetValue("Lang").ToString();

            string enresx = @".\en.resx";
            string frresx = @".\fr.resx";
            //Chose the ResX file
            if (utls == "EN") resxFile = enresx;    //English   
            else resxFile = frresx;                //French
            ResXResourceSet resxSet = new ResXResourceSet(resxFile);

            desc.Text = resxSet.GetString("descpsbr");
        }

        private void desc_dismbr(object sender, EventArgs e)
        {
            //Check the current saved language

            RegistryKey utl = Registry.CurrentUser.OpenSubKey(@"Software\STY1001\Unowhy Tools", false);
            string utls = utl.GetValue("Lang").ToString();

            string enresx = @".\en.resx";
            string frresx = @".\fr.resx";
            //Chose the ResX file
            if (utls == "EN") resxFile = enresx;    //English   
            else resxFile = frresx;                //French
            ResXResourceSet resxSet = new ResXResourceSet(resxFile);

            desc.Text = resxSet.GetString("descdismbr");
        }

        private void desc_enwhe(object sender, EventArgs e)
        {
            //Check the current saved language

            RegistryKey utl = Registry.CurrentUser.OpenSubKey(@"Software\STY1001\Unowhy Tools", false);
            string utls = utl.GetValue("Lang").ToString();

            string enresx = @".\en.resx";
            string frresx = @".\fr.resx";
            //Chose the ResX file
            if (utls == "EN") resxFile = enresx;    //English   
            else resxFile = frresx;                //French
            ResXResourceSet resxSet = new ResXResourceSet(resxFile);

            desc.Text = resxSet.GetString("descenwhe");
        }

        private void desc_bkcloud(object sender, EventArgs e)
        {
            //Check the current saved language

            RegistryKey utl = Registry.CurrentUser.OpenSubKey(@"Software\STY1001\Unowhy Tools", false);
            string utls = utl.GetValue("Lang").ToString();

            string enresx = @".\en.resx";
            string frresx = @".\fr.resx";
            //Chose the ResX file
            if (utls == "EN") resxFile = enresx;    //English   
            else resxFile = frresx;                //French
            ResXResourceSet resxSet = new ResXResourceSet(resxFile);

            desc.Text = resxSet.GetString("descbkcloud");
        }

        private void desc_bootim(object sender, EventArgs e)
        {
            //Check the current saved language

            RegistryKey utl = Registry.CurrentUser.OpenSubKey(@"Software\STY1001\Unowhy Tools", false);
            string utls = utl.GetValue("Lang").ToString();

            string enresx = @".\en.resx";
            string frresx = @".\fr.resx";
            //Chose the ResX file
            if (utls == "EN") resxFile = enresx;    //English   
            else resxFile = frresx;                //French
            ResXResourceSet resxSet = new ResXResourceSet(resxFile);

            desc.Text = resxSet.GetString("descbootim");
        }

        #endregion

        private void main_Load(object sender, EventArgs e)
        {

        }
    }
}
